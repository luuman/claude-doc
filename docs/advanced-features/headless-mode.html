<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-advanced-features/headless-mode" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Headless 模式（无头模式） | Claude Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luuman.github.io/claude-doc/docs/advanced-features/headless-mode"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Headless 模式（无头模式） | Claude Docs"><meta data-rh="true" name="description" content="在 CI/CD 流水线、脚本自动化和批量处理场景中使用 Claude Code 的非交互式模式"><meta data-rh="true" property="og:description" content="在 CI/CD 流水线、脚本自动化和批量处理场景中使用 Claude Code 的非交互式模式"><link data-rh="true" rel="icon" href="/claude-doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luuman.github.io/claude-doc/docs/advanced-features/headless-mode"><link data-rh="true" rel="alternate" href="https://luuman.github.io/claude-doc/docs/advanced-features/headless-mode" hreflang="zh"><link data-rh="true" rel="alternate" href="https://luuman.github.io/claude-doc/docs/advanced-features/headless-mode" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Headless 模式（无头模式）","item":"https://luuman.github.io/claude-doc/docs/advanced-features/headless-mode"}]}</script><link rel="alternate" type="application/rss+xml" href="/claude-doc/blog/rss.xml" title="Claude Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/claude-doc/blog/atom.xml" title="Claude Docs Atom Feed"><link rel="stylesheet" href="/claude-doc/assets/css/styles.b961a2e4.css">
<script src="/claude-doc/assets/js/runtime~main.b2563310.js" defer="defer"></script>
<script src="/claude-doc/assets/js/main.906b66fd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbar_MONK" role="navigation" aria-label="Main"><div class="navbarInner_ASTH"><div class="navbarLeft_pUmY"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="brand_SXL9" href="/claude-doc/"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="6" fill="var(--ifm-color-primary)"></rect><path d="M7 8.5h10M7 12h7M7 15.5h10" stroke="white" stroke-width="1.8" stroke-linecap="round"></path></svg><span class="brandTitle_XbyU">Claude</span></a><div class="dropdown_GrgZ"><button class="dropdownToggle_Nf_z">全部站点<svg class="dropdownArrow_Eka8" viewBox="0 0 12 12" fill="none"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><ul class="dropdownMenu_zsxH"><li><a href="https://luuman.github.io/docs-workspace/docs" class="dropdownMenuItem_VBaP">Workspace</a></li><li><a href="https://luuman.github.io/moltbot-doc/docs" class="dropdownMenuItem_VBaP">Moltbot</a></li><li><a href="https://luuman.github.io/electron-doc/docs" class="dropdownMenuItem_VBaP">Electron</a></li><li><a href="https://luuman.github.io/tauri-doc/docs" class="dropdownMenuItem_VBaP">Tauri</a></li><li><a href="https://luuman.github.io/matrx-doc/docs" class="dropdownMenuItem_VBaP">Matrx</a></li><li><a href="https://luuman.github.io/brainboard-doc/docs" class="dropdownMenuItem_VBaP">Brainboard</a></li><li><a href="https://luuman.github.io/synology-doc/docs" class="dropdownMenuItem_VBaP">Synology</a></li><li><a href="https://luuman.github.io/codex-doc/docs" class="dropdownMenuItem_VBaP">Codex</a></li><li><a href="https://luuman.github.io/ai-doc/docs" class="dropdownMenuItem_VBaP">AI</a></li></ul></div></div><div class="navbarCenter_Zdr3"><div class="root_OF3s"><span class="icon_UcOK" aria-hidden="true"><svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></span><div class="slot__FGx"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div class="navbarRight_q16u"><a class="navLink_RnnM" href="/claude-doc/docs">Docs</a><a class="navLink_RnnM" href="/claude-doc/blog">Blog</a><button class="themeToggle_zD_x" aria-label="Switch to light theme" title="Light"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/claude-doc/docs"><span title="Claude Code 完全指南" class="linkLabel_WmDU">Claude Code 完全指南</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/claude-doc/docs/getting-started"><span title="快速开始" class="linkLabel_WmDU">快速开始</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/claude-doc/docs/core-concepts/skills"><span title="核心概念" class="categoryLinkLabel_W154">核心概念</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/core-concepts/skills"><span title="Skills（技能包）" class="linkLabel_WmDU">Skills（技能包）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/core-concepts/hooks"><span title="Hooks（钩子）" class="linkLabel_WmDU">Hooks（钩子）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/core-concepts/plugins"><span title="Plugins（插件）" class="linkLabel_WmDU">Plugins（插件）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/core-concepts/mcp-servers"><span title="MCP Servers（模型上下文协议）" class="linkLabel_WmDU">MCP Servers（模型上下文协议）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/core-concepts/subagents"><span title="Subagents（子代理）" class="linkLabel_WmDU">Subagents（子代理）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/core-concepts/claude-md"><span title="CLAUDE.md（项目记忆文件）" class="linkLabel_WmDU">CLAUDE.md（项目记忆文件）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/core-concepts/memory"><span title="Memory（自动记忆）" class="linkLabel_WmDU">Memory（自动记忆）</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/claude-doc/docs/advanced-features/plan-mode"><span title="高级功能" class="categoryLinkLabel_W154">高级功能</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/advanced-features/plan-mode"><span title="Plan 模式（规划模式）" class="linkLabel_WmDU">Plan 模式（规划模式）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/claude-doc/docs/advanced-features/headless-mode"><span title="Headless 模式（无头模式）" class="linkLabel_WmDU">Headless 模式（无头模式）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/advanced-features/slash-commands"><span title="自定义斜杠命令" class="linkLabel_WmDU">自定义斜杠命令</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/advanced-features/agent-sdk"><span title="Claude Agent SDK" class="linkLabel_WmDU">Claude Agent SDK</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/advanced-features/ide-integration"><span title="IDE 集成" class="linkLabel_WmDU">IDE 集成</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/advanced-features/vibecraft"><span title="VibeCraft — Claude Code 3D 可视化" class="linkLabel_WmDU">VibeCraft — Claude Code 3D 可视化</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/claude-doc/docs/best-practices/workflow"><span title="最佳实践" class="categoryLinkLabel_W154">最佳实践</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/best-practices/workflow"><span title="工作流最佳实践" class="linkLabel_WmDU">工作流最佳实践</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/best-practices/performance"><span title="性能优化" class="linkLabel_WmDU">性能优化</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/best-practices/security"><span title="安全与故障排查" class="linkLabel_WmDU">安全与故障排查</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/claude-doc/docs/category/真实场景案例库"><span title="真实场景案例库" class="categoryLinkLabel_W154">真实场景案例库</span></a><button aria-label="折叠侧边栏分类 &#x27;真实场景案例库&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases"><span title="真实场景案例库" class="linkLabel_WmDU">真实场景案例库</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/frontend-acceleration"><span title="React 项目加速" class="linkLabel_WmDU">React 项目加速</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/ui-components"><span title="UI 组件库自动化" class="linkLabel_WmDU">UI 组件库自动化</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/backend-api"><span title="API 快速开发" class="linkLabel_WmDU">API 快速开发</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/database-migration"><span title="数据库迁移和优化" class="linkLabel_WmDU">数据库迁移和优化</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/cicd-automation"><span title="CI/CD 流程自动化" class="linkLabel_WmDU">CI/CD 流程自动化</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/infrastructure-as-code"><span title="基础设施即代码（IaC）" class="linkLabel_WmDU">基础设施即代码（IaC）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/api-documentation"><span title="API 文档自动化" class="linkLabel_WmDU">API 文档自动化</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/technical-writing"><span title="技术文档写作" class="linkLabel_WmDU">技术文档写作</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/code-review"><span title="代码审查自动化" class="linkLabel_WmDU">代码审查自动化</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/claude-doc/docs/use-cases/knowledge-base"><span title="知识库维护" class="linkLabel_WmDU">知识库维护</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/claude-doc/docs/quick-reference"><span title="速查手册" class="linkLabel_WmDU">速查手册</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/claude-doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">高级功能</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Headless 模式（无头模式）</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Headless 模式（无头模式）</h1></header>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>适用场景</div><div class="admonitionContent_BuS1"><p>Headless 模式让 Claude Code 脱离交互式界面，以<strong>命令行管道</strong>或<strong>脚本调用</strong>的形式工作。这是将 AI 能力集成到自动化工作流的核心方式，适用于 CI/CD、批量处理、定时任务等场景。</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="基本用法">基本用法<a href="#基本用法" class="hash-link" aria-label="基本用法的直接链接" title="基本用法的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="核心参数">核心参数<a href="#核心参数" class="hash-link" aria-label="核心参数的直接链接" title="核心参数的直接链接" translate="no">​</a></h3>

































<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td><code>-p &quot;提示词&quot;</code></td><td>指定提示词（非交互式执行）</td></tr><tr><td><code>--output-format json</code></td><td>以 JSON 格式输出结果</td></tr><tr><td><code>--output-format stream-json</code></td><td>流式 JSON 输出（实时）</td></tr><tr><td><code>--verbose</code></td><td>显示详细的思考过程和工具调用</td></tr><tr><td><code>--dangerously-skip-permissions</code></td><td>跳过权限确认（CI 环境专用）</td></tr><tr><td><code>--max-turns N</code></td><td>限制最大对话轮数</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="管道输入">管道输入<a href="#管道输入" class="hash-link" aria-label="管道输入的直接链接" title="管道输入的直接链接" translate="no">​</a></h3>
<p>最常见的用法是通过 Unix 管道将内容传递给 Claude：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 解释 git diff 的变更内容</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">git diff | claude -p &quot;解释这些代码变更，重点说明影响范围和潜在风险&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 总结文件内容</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">cat README.md | claude -p &quot;用 3 句话总结这个项目的核心功能&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 分析日志文件中的错误</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">tail -n 100 /var/log/app.log | claude -p &quot;找出其中的错误模式，按严重程度分类&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 检查代码质量</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">cat src/main.js | claude -p &quot;检查代码质量，指出潜在的 Bug 和不良实践&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="文件重定向输入">文件重定向输入<a href="#文件重定向输入" class="hash-link" aria-label="文件重定向输入的直接链接" title="文件重定向输入的直接链接" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 使用重定向符号传入文件</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">claude -p &quot;检查代码质量&quot; &lt; src/main.js</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 组合多个文件（通过 heredoc）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">claude -p &quot;对比这两个配置文件的差异&quot; &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">$(cat config/dev.json)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">---</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">$(cat config/prod.json)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">EOF</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="命令行直接分析">命令行直接分析<a href="#命令行直接分析" class="hash-link" aria-label="命令行直接分析的直接链接" title="命令行直接分析的直接链接" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 分析目录结构</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">ls -la src/ | claude -p &quot;根据这个目录结构，描述项目的模块划分方式&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 分析系统信息</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">df -h | claude -p &quot;判断磁盘使用情况是否需要关注，给出建议&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 审查提交历史</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">git log --oneline -20 | claude -p &quot;分析最近 20 次提交的工作模式，有无不规范之处&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="stream-json-输出格式">Stream-JSON 输出格式<a href="#stream-json-输出格式" class="hash-link" aria-label="Stream-JSON 输出格式的直接链接" title="Stream-JSON 输出格式的直接链接" translate="no">​</a></h2>
<p>对于需要程序化处理 Claude 输出的场景，使用结构化输出格式：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 基础 stream-json 输出</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">claude -p &quot;分析这段代码的复杂度&quot; \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  --dangerously-skip-permissions \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  --output-format stream-json \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  --verbose \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &lt; src/complex-module.js</span><br></span></code></pre></div></div>
<p>输出格式示例：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token punctuation" style="color:#C792EA">{</span><span class="token property" style="color:#F78C6C">&quot;type&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;thinking&quot;</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token property" style="color:#F78C6C">&quot;content&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;正在分析代码结构...&quot;</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token punctuation" style="color:#C792EA">{</span><span class="token property" style="color:#F78C6C">&quot;type&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;tool_use&quot;</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token property" style="color:#F78C6C">&quot;tool&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;Read&quot;</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token property" style="color:#F78C6C">&quot;input&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token property" style="color:#F78C6C">&quot;file_path&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;src/complex-module.js&quot;</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token punctuation" style="color:#C792EA">{</span><span class="token property" style="color:#F78C6C">&quot;type&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;tool_result&quot;</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token property" style="color:#F78C6C">&quot;content&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;// 文件内容...&quot;</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token punctuation" style="color:#C792EA">{</span><span class="token property" style="color:#F78C6C">&quot;type&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;text&quot;</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token property" style="color:#F78C6C">&quot;content&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;该模块的圈复杂度约为 12，主要集中在...&quot;</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token punctuation" style="color:#C792EA">{</span><span class="token property" style="color:#F78C6C">&quot;type&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token string" style="color:#ECC48D">&quot;result&quot;</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token property" style="color:#F78C6C">&quot;exit_code&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token number" style="color:#F78C6C">0</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token property" style="color:#F78C6C">&quot;cost_usd&quot;</span><span class="token operator" style="color:#7FDBCA">:</span><span class="token number" style="color:#F78C6C">0.0023</span><span class="token punctuation" style="color:#C792EA">}</span><br></span></code></pre></div></div>
<p>使用 <code>jq</code> 提取特定字段：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">claude -p &quot;列出所有 TODO 注释&quot; \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  --output-format stream-json \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &lt; src/app.js | \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  jq -r &#x27;select(.type==&quot;text&quot;) | .content&#x27;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cicd-集成">CI/CD 集成<a href="#cicd-集成" class="hash-link" aria-label="CI/CD 集成的直接链接" title="CI/CD 集成的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="github-actions-完整示例">GitHub Actions 完整示例<a href="#github-actions-完整示例" class="hash-link" aria-label="GitHub Actions 完整示例的直接链接" title="GitHub Actions 完整示例的直接链接" translate="no">​</a></h3>
<p>以下是一个完整的 GitHub Actions 工作流，在每次 PR 时自动触发 Claude Code 进行代码审查：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockTitle_OeMC">.github/workflows/claude-review.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Claude Code Review</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token key atrule" style="color:#C792EA">on</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">pull_request</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">types</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">opened</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token plain"> synchronize</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token plain"> reopened</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">paths</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token string" style="color:#ECC48D">&#x27;src/**&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token string" style="color:#ECC48D">&#x27;tests/**&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token key atrule" style="color:#C792EA">jobs</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">claude-review</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> AI 代码审查</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">runs-on</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">permissions</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">contents</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> read</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">pull-requests</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">steps</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># 1. 检出代码（包含完整历史以支持 diff）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Checkout Repository</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">uses</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">with</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">fetch-depth</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token number" style="color:#F78C6C">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># 2. 配置 Node.js 环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Setup Node.js</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">uses</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">node@v4</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">with</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">node-version</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token string" style="color:#ECC48D">&#x27;20&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">cache</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token string" style="color:#ECC48D">&#x27;npm&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># 3. 安装 Claude Code CLI</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Install Claude Code</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">run</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> npm install </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">g @anthropic</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">ai/claude</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">code</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># 4. 生成 PR Diff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Generate PR Diff</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">id</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> diff</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">run</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#C792EA">|</span><span class="token scalar string" style="color:#ECC48D"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          git diff origin/${{ github.base_ref }}...HEAD \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">            -- &#x27;*.ts&#x27; &#x27;*.tsx&#x27; &#x27;*.js&#x27; &#x27;*.jsx&#x27; &#x27;*.py&#x27; \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">            &gt; /tmp/pr-diff.txt</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          echo &quot;diff_lines=$(wc -l &lt; /tmp/pr-diff.txt)&quot; &gt;&gt; $GITHUB_OUTPUT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># 5. 运行 Claude 代码审查</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Run Claude Review</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">id</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> review</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">env</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">ANTHROPIC_API_KEY</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain"> secrets.ANTHROPIC_API_KEY </span><span class="token punctuation" style="color:#C792EA">}</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">run</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#C792EA">|</span><span class="token scalar string" style="color:#ECC48D"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          REVIEW=$(cat /tmp/pr-diff.txt | claude -p &quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          请对以下代码变更进行专业的代码审查，输出格式如下：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token comment" style="color:#637777;font-style:italic">## 总体评价</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">简短总结</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token comment" style="color:#637777;font-style:italic">## 潜在问题</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">列出发现的 Bug 或安全隐患</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token comment" style="color:#637777;font-style:italic">## 代码质量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">评价代码风格、可读性、可维护性</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token comment" style="color:#637777;font-style:italic">## 改进建议</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">具体的优化建议</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token comment" style="color:#637777;font-style:italic">## 优点</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">值得肯定的实践</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          &quot; </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">dangerously</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">skip</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">permissions 2</span><span class="token punctuation" style="color:#C792EA">&gt;</span><span class="token plain">/dev/null)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token comment" style="color:#637777;font-style:italic"># 将多行输出存储为环境变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            echo &#x27;REVIEW_CONTENT&lt;&lt;REVIEW_EOF&#x27;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            echo &quot;$REVIEW&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            echo &#x27;REVIEW_EOF&#x27;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#C792EA">&gt;</span><span class="token punctuation" style="color:#C792EA">&gt;</span><span class="token plain"> $GITHUB_ENV</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># 6. 将审查结果评论到 PR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Comment Review on PR</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">uses</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> actions/github</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">script@v7</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">with</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">github-token</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain"> secrets.GITHUB_TOKEN </span><span class="token punctuation" style="color:#C792EA">}</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">script</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#C792EA">|</span><span class="token scalar string" style="color:#ECC48D"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">            const review = process.env.REVIEW_CONTENT;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">            const diffLines = &#x27;${{ steps.diff.outputs.diff_lines }}&#x27;;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            await github.rest.issues.createComment(</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              </span><span class="token key atrule" style="color:#C792EA">owner</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> context.repo.owner</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              </span><span class="token key atrule" style="color:#C792EA">repo</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> context.repo.repo</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              </span><span class="token key atrule" style="color:#C792EA">issue_number</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> context.issue.number</span><span class="token punctuation" style="color:#C792EA">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              </span><span class="token key atrule" style="color:#C792EA">body</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> `</span><span class="token comment" style="color:#637777;font-style:italic">## 🤖 Claude Code 自动审查报告\n\n` +</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">                    `</span><span class="token punctuation" style="color:#C792EA">&gt;</span><span class="token plain"> 审查范围：$</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain">diffLines</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"> 行变更\n\n` +</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">                    `$</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain">review</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain">\n\n` +</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">                    `</span><span class="token punctuation" style="color:#C792EA">---</span><span class="token plain">\n</span><span class="token important" style="color:#D6DEEB">*由</span><span class="token plain"> Claude Code 自动生成 · $</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain">new Date().toISOString()</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token important" style="color:#D6DEEB">*`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            </span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain">);</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># 7. 安全检查（可选）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#C792EA">name</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> Security Scan</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">env</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">ANTHROPIC_API_KEY</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token punctuation" style="color:#C792EA">{</span><span class="token plain"> secrets.ANTHROPIC_API_KEY </span><span class="token punctuation" style="color:#C792EA">}</span><span class="token punctuation" style="color:#C792EA">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">run</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#C792EA">|</span><span class="token scalar string" style="color:#ECC48D"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          cat /tmp/pr-diff.txt | claude -p &quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          专注于安全角度审查以下代码变更：</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          1. SQL 注入风险</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          2. XSS 漏洞</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          3. 敏感信息泄露（API Key、密码硬编码）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          4. 不安全的依赖</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">          5. 权限控制缺失</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          如果发现高危问题，请在输出开头标注 </span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">HIGH_RISK</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          &quot; </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">dangerously</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">skip</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">permissions 2</span><span class="token punctuation" style="color:#C792EA">&gt;</span><span class="token plain">/dev/null </span><span class="token punctuation" style="color:#C792EA">|</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          grep </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">q &quot;\</span><span class="token punctuation" style="color:#C792EA">[</span><span class="token plain">HIGH_RISK\</span><span class="token punctuation" style="color:#C792EA">]</span><span class="token plain">&quot; </span><span class="token important" style="color:#D6DEEB">&amp;&amp;</span><span class="token plain"> exit 1 </span><span class="token punctuation" style="color:#C792EA">|</span><span class="token punctuation" style="color:#C792EA">|</span><span class="token plain"> exit 0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gitlab-ci-示例">GitLab CI 示例<a href="#gitlab-ci-示例" class="hash-link" aria-label="GitLab CI 示例的直接链接" title="GitLab CI 示例的直接链接" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockTitle_OeMC">.gitlab-ci.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token key atrule" style="color:#C792EA">claude-code-review</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">stage</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> test</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">image</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> node</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain">20</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">only</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> merge_requests</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">script</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> npm install </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">g @anthropic</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">ai/claude</span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain">code</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> git diff $CI_MERGE_REQUEST_DIFF_BASE_SHA</span><span class="token punctuation" style="color:#C792EA">...</span><span class="token plain">HEAD </span><span class="token punctuation" style="color:#C792EA">&gt;</span><span class="token plain"> /tmp/diff.txt</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#C792EA">|</span><span class="token scalar string" style="color:#ECC48D"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">      cat /tmp/diff.txt | claude -p &quot;进行代码审查并输出 Markdown 格式报告&quot; \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token scalar string" style="color:#ECC48D">        --dangerously-skip-permissions &gt; review.md</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">artifacts</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">paths</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token punctuation" style="color:#C792EA">-</span><span class="token plain"> review.md</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">expire_in</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> 1 week</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="脚本自动化">脚本自动化<a href="#脚本自动化" class="hash-link" aria-label="脚本自动化的直接链接" title="脚本自动化的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="批量代码质量分析">批量代码质量分析<a href="#批量代码质量分析" class="hash-link" aria-label="批量代码质量分析的直接链接" title="批量代码质量分析的直接链接" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockTitle_OeMC">scripts/batch-process.sh</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># batch-process.sh - 批量分析代码质量</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 用法: ./batch-process.sh [目标目录]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">set -euo pipefail</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">TARGET_DIR=&quot;${1:-./src}&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">OUTPUT_DIR=&quot;./quality-reports&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">TIMESTAMP=$(date +%Y%m%d_%H%M%S)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">REPORT_FILE=&quot;${OUTPUT_DIR}/quality-report-${TIMESTAMP}.md&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 创建输出目录</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">mkdir -p &quot;$OUTPUT_DIR&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 初始化报告</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">cat &gt; &quot;$REPORT_FILE&quot; &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 代码质量分析报告</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- 分析时间：$(date)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- 目标目录：${TARGET_DIR}</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- 分析工具：Claude Code Headless</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">---</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;开始批量分析 ${TARGET_DIR} 目录...&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 统计计数</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">total=0</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">analyzed=0</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">issues_found=0</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 遍历目标文件（TypeScript 和 JavaScript）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">while IFS= read -r -d &#x27;&#x27; file; do</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  total=$((total + 1))</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  filename=$(basename &quot;$file&quot;)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  # 跳过测试文件和配置文件</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  if [[ &quot;$filename&quot; == *.test.* ]] || [[ &quot;$filename&quot; == *.config.* ]]; then</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    continue</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  fi</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  echo &quot;分析: $file&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  # 调用 Claude 分析（带超时保护）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  analysis=$(timeout 60 claude -p &quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">分析以下代码文件，重点检查：</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">1. 潜在的 Bug（空指针、边界条件、类型错误）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">2. 性能问题（不必要的循环、内存泄露风险）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">3. 代码异味（过长函数、重复代码、魔法数字）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">4. 缺失的错误处理</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">输出格式（JSON）：</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  \&quot;score\&quot;: 1-10,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  \&quot;issues\&quot;: [\&quot;issue1\&quot;, \&quot;issue2\&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  \&quot;summary\&quot;: \&quot;一句话总结\&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">&quot; --dangerously-skip-permissions \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    --output-format json \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    &lt; &quot;$file&quot; 2&gt;/dev/null || echo &#x27;{&quot;score&quot;:0,&quot;issues&quot;:[&quot;分析超时&quot;],&quot;summary&quot;:&quot;跳过&quot;}&#x27;)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  # 提取评分</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  score=$(echo &quot;$analysis&quot; | jq -r &#x27;.score // 0&#x27; 2&gt;/dev/null || echo &quot;0&quot;)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  summary=$(echo &quot;$analysis&quot; | jq -r &#x27;.summary // &quot;无&quot;&#x27; 2&gt;/dev/null || echo &quot;无&quot;)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  # 写入报告</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  cat &gt;&gt; &quot;$REPORT_FILE&quot; &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">## ${file}</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- **质量评分：** ${score}/10</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- **问题摘要：** ${summary}</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  analyzed=$((analyzed + 1))</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  # 低分文件计入问题统计</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  if [ &quot;$score&quot; -lt 6 ] 2&gt;/dev/null; then</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    issues_found=$((issues_found + 1))</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  fi</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  # 避免 API 频率限制</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  sleep 1</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">done &lt; &lt;(find &quot;$TARGET_DIR&quot; -type f \( -name &quot;*.ts&quot; -o -name &quot;*.js&quot; \) -print0)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 写入汇总</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">cat &gt;&gt; &quot;$REPORT_FILE&quot; &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">---</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">## 汇总统计</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">| 指标 | 数值 |</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">|------|------|</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">| 扫描文件总数 | ${total} |</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">| 成功分析数 | ${analyzed} |</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">| 需关注文件数 | ${issues_found} |</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;分析完成！&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;报告已保存至：${REPORT_FILE}&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;扫描：${total} 个文件，分析：${analyzed} 个，需关注：${issues_found} 个&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="自动生成提交信息">自动生成提交信息<a href="#自动生成提交信息" class="hash-link" aria-label="自动生成提交信息的直接链接" title="自动生成提交信息的直接链接" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockTitle_OeMC">scripts/auto-commit-msg.sh</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 根据 git diff 自动生成规范的提交信息</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">DIFF=$(git diff --cached)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">if [ -z &quot;$DIFF&quot; ]; then</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  echo &quot;没有已暂存的变更&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  exit 1</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;正在生成提交信息...&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">COMMIT_MSG=$(echo &quot;$DIFF&quot; | claude -p &quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">根据以下 git diff 生成一条规范的 Git 提交信息。</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">要求：</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">1. 遵循 Conventional Commits 规范（feat/fix/docs/refactor/test/chore）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">2. 标题不超过 72 个字符</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">3. 使用中文</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">4. 如有必要，添加简短的 body 说明</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">只输出提交信息本身，不要其他内容。</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">&quot; --dangerously-skip-permissions 2&gt;/dev/null)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;建议的提交信息：&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;---&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;$COMMIT_MSG&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;---&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">read -rp &quot;使用此提交信息？(y/n/e[编辑]): &quot; choice</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">case &quot;$choice&quot; in</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  y|Y) git commit -m &quot;$COMMIT_MSG&quot; ;;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  e|E) git commit -e -m &quot;$COMMIT_MSG&quot; ;;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  *) echo &quot;已取消&quot; ;;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">esac</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="定时代码健康检查">定时代码健康检查<a href="#定时代码健康检查" class="hash-link" aria-label="定时代码健康检查的直接链接" title="定时代码健康检查的直接链接" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockTitle_OeMC">scripts/daily-health-check.sh</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 每日代码健康检查（配合 cron 使用）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># cron: 0 9 * * 1-5 /path/to/daily-health-check.sh</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">SLACK_WEBHOOK=&quot;${SLACK_WEBHOOK_URL:-}&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">PROJECT_ROOT=&quot;/path/to/your/project&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 生成健康报告</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">report=$(git -C &quot;$PROJECT_ROOT&quot; log --since=&quot;24 hours ago&quot; --oneline | \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  claude -p &quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">分析过去 24 小时的提交记录，生成每日健康报告：</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">1. 活跃度评估</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">2. 主要工作内容</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">3. 需要关注的模式（如频繁修复同一模块）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">输出简洁的 Slack 消息格式（Markdown）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">&quot; --dangerously-skip-permissions 2&gt;/dev/null)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 发送到 Slack</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">if [ -n &quot;$SLACK_WEBHOOK&quot; ]; then</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  curl -s -X POST &quot;$SLACK_WEBHOOK&quot; \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    -H &#x27;Content-type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    --data &quot;{\&quot;text\&quot;: \&quot;*每日代码健康报告*\n${report}\&quot;}&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">echo &quot;$report&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="最佳实践">最佳实践<a href="#最佳实践" class="hash-link" aria-label="最佳实践的直接链接" title="最佳实践的直接链接" translate="no">​</a></h2>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><mdxadmonitiontitle>关于 <code>--dangerously-skip-permissions</code></mdxadmonitiontitle><p>此参数会跳过所有权限确认提示，<strong>仅适用于 CI/CD 环境或受控的自动化脚本</strong>。在本地开发环境中，建议去掉此参数以保留安全保护。</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="输出处理技巧">输出处理技巧<a href="#输出处理技巧" class="hash-link" aria-label="输出处理技巧的直接链接" title="输出处理技巧的直接链接" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 仅提取文本输出（过滤系统消息）</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">claude -p &quot;...&quot; --output-format stream-json | \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  jq -r &#x27;select(.type==&quot;text&quot;) | .content&#x27; | \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tr -d &#x27;\n&#x27;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 提取最终成本</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">claude -p &quot;...&quot; --output-format stream-json | \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  jq -r &#x27;select(.type==&quot;result&quot;) | &quot;Cost: $\(.cost_usd)&quot;&#x27;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"># 检查是否执行成功</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">claude -p &quot;...&quot; --output-format json | jq -e &#x27;.exit_code == 0&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="性能优化">性能优化<a href="#性能优化" class="hash-link" aria-label="性能优化的直接链接" title="性能优化的直接链接" translate="no">​</a></h3>





























<table><thead><tr><th>策略</th><th>说明</th></tr></thead><tbody><tr><td>限制输入大小</td><td>超大文件先用 <code>head -n 200</code> 截取关键部分</td></tr><tr><td>使用 <code>--max-turns</code></td><td>防止复杂任务无限循环</td></tr><tr><td>并行处理</td><td>使用 <code>xargs -P 4</code> 并行分析多个文件</td></tr><tr><td>缓存结果</td><td>对相同内容的分析结果做本地缓存</td></tr><tr><td>指定模型</td><td><code>--model claude-haiku-4-5</code> 用于简单任务节省成本</td></tr></tbody></table></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/claude-doc/docs/advanced-features/plan-mode"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Plan 模式（规划模式）</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/claude-doc/docs/advanced-features/slash-commands"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">自定义斜杠命令</div></a></nav></div></div><div class="col col--3"><div class="tocWrapper_xKoj"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#基本用法" class="table-of-contents__link toc-highlight">基本用法</a><ul><li><a href="#核心参数" class="table-of-contents__link toc-highlight">核心参数</a></li><li><a href="#管道输入" class="table-of-contents__link toc-highlight">管道输入</a></li><li><a href="#文件重定向输入" class="table-of-contents__link toc-highlight">文件重定向输入</a></li><li><a href="#命令行直接分析" class="table-of-contents__link toc-highlight">命令行直接分析</a></li></ul></li><li><a href="#stream-json-输出格式" class="table-of-contents__link toc-highlight">Stream-JSON 输出格式</a></li><li><a href="#cicd-集成" class="table-of-contents__link toc-highlight">CI/CD 集成</a><ul><li><a href="#github-actions-完整示例" class="table-of-contents__link toc-highlight">GitHub Actions 完整示例</a></li><li><a href="#gitlab-ci-示例" class="table-of-contents__link toc-highlight">GitLab CI 示例</a></li></ul></li><li><a href="#脚本自动化" class="table-of-contents__link toc-highlight">脚本自动化</a><ul><li><a href="#批量代码质量分析" class="table-of-contents__link toc-highlight">批量代码质量分析</a></li><li><a href="#自动生成提交信息" class="table-of-contents__link toc-highlight">自动生成提交信息</a></li><li><a href="#定时代码健康检查" class="table-of-contents__link toc-highlight">定时代码健康检查</a></li></ul></li><li><a href="#最佳实践" class="table-of-contents__link toc-highlight">最佳实践</a><ul><li><a href="#输出处理技巧" class="table-of-contents__link toc-highlight">输出处理技巧</a></li><li><a href="#性能优化" class="table-of-contents__link toc-highlight">性能优化</a></li></ul></li></ul></div><div class="tocFooter_Fu2z"><div class="themeGroup_RzWV" role="group" aria-label="Theme"><button class="themeBtn_tGr6" aria-label="Light theme" title="Light"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button><button class="themeBtn_tGr6 themeBtnActive_A6tm" aria-label="Dark theme" title="Dark"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M11.38 2.019a7.5 7.5 0 1 0 10.6 10.6C21.83 17.963 17.315 22 12.002 22 6.477 22 2 17.523 2 12c0-5.314 4.038-9.827 9.38-10.28z"></path></svg></button></div></div></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Claude Docs.</div></div></div></footer></div>
</body>
</html>